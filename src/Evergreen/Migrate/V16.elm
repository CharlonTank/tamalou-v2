module Evergreen.Migrate.V16 exposing (..)

{-| This migration file was automatically generated by the lamdera compiler.

It includes:

  - A migration for each of the 6 Lamdera core types that has changed
  - A function named `migrate_ModuleName_TypeName` for each changed/custom type

Expect to see:

  - `Unimplement–µd` values as placeholders wherever I was unable to figure out a clear migration path for you
  - `@NOTICE` comments for things you should know about, i.e. new custom type constructors that won't get any
    value mappings from the old type by default

You can edit this file however you wish! It won't be generated again.

See <https://dashboard.lamdera.app/docs/evergreen> for more info.

-}

import Evergreen.V15.Card
import Evergreen.V15.Types
import Evergreen.V16.Card
import Evergreen.V16.Types
import Lamdera.Migrations exposing (..)
import List


frontendModel : Evergreen.V15.Types.FrontendModel -> ModelMigration Evergreen.V16.Types.FrontendModel Evergreen.V16.Types.FrontendMsg
frontendModel old =
    ModelMigrated ( migrate_Types_FrontendModel old, Cmd.none )


backendModel : Evergreen.V15.Types.BackendModel -> ModelMigration Evergreen.V16.Types.BackendModel Evergreen.V16.Types.BackendMsg
backendModel old =
    ModelUnchanged


frontendMsg : Evergreen.V15.Types.FrontendMsg -> MsgMigration Evergreen.V16.Types.FrontendMsg Evergreen.V16.Types.FrontendMsg
frontendMsg old =
    MsgMigrated ( migrate_Types_FrontendMsg old, Cmd.none )


toBackend : Evergreen.V15.Types.ToBackend -> MsgMigration Evergreen.V16.Types.ToBackend Evergreen.V16.Types.BackendMsg
toBackend old =
    MsgUnchanged


backendMsg : Evergreen.V15.Types.BackendMsg -> MsgMigration Evergreen.V16.Types.BackendMsg Evergreen.V16.Types.BackendMsg
backendMsg old =
    MsgUnchanged


toFrontend : Evergreen.V15.Types.ToFrontend -> MsgMigration Evergreen.V16.Types.ToFrontend Evergreen.V16.Types.FrontendMsg
toFrontend old =
    MsgUnchanged


migrate_Types_FrontendModel : Evergreen.V15.Types.FrontendModel -> Evergreen.V16.Types.FrontendModel
migrate_Types_FrontendModel old =
    { key = old.key
    , device = old.device
    , gameFrontend = old.gameFrontend |> migrate_Types_FGame
    , clientId = old.clientId
    , sessionId = old.sessionId
    , urlPath = old.urlPath
    , errors = old.errors
    , admin = old.admin
    , screenHeight = 0
    }


migrate_Card_Card : Evergreen.V15.Card.Card -> Evergreen.V16.Card.Card
migrate_Card_Card old =
    { suit = old.suit |> migrate_Card_Suit
    , rank = old.rank |> migrate_Card_Rank
    , show = old.show
    }


migrate_Card_FCard : Evergreen.V15.Card.FCard -> Evergreen.V16.Card.FCard
migrate_Card_FCard old =
    case old of
        Evergreen.V15.Card.FaceUp p0 ->
            Evergreen.V16.Card.FaceUp (p0 |> migrate_Card_Card)

        Evergreen.V15.Card.FaceDown ->
            Evergreen.V16.Card.FaceDown


migrate_Card_Power : Evergreen.V15.Card.Power -> Evergreen.V16.Card.Power
migrate_Card_Power old =
    case old of
        Evergreen.V15.Card.PlayAgain ->
            Evergreen.V16.Card.PlayAgain

        Evergreen.V15.Card.Switch2Cards ->
            Evergreen.V16.Card.Switch2Cards

        Evergreen.V15.Card.LookACard ->
            Evergreen.V16.Card.LookACard


migrate_Card_Rank : Evergreen.V15.Card.Rank -> Evergreen.V16.Card.Rank
migrate_Card_Rank old =
    case old of
        Evergreen.V15.Card.Ace ->
            Evergreen.V16.Card.Ace

        Evergreen.V15.Card.Two ->
            Evergreen.V16.Card.Two

        Evergreen.V15.Card.Three ->
            Evergreen.V16.Card.Three

        Evergreen.V15.Card.Four ->
            Evergreen.V16.Card.Four

        Evergreen.V15.Card.Five ->
            Evergreen.V16.Card.Five

        Evergreen.V15.Card.Six ->
            Evergreen.V16.Card.Six

        Evergreen.V15.Card.Seven ->
            Evergreen.V16.Card.Seven

        Evergreen.V15.Card.Eight ->
            Evergreen.V16.Card.Eight

        Evergreen.V15.Card.Nine ->
            Evergreen.V16.Card.Nine

        Evergreen.V15.Card.Ten ->
            Evergreen.V16.Card.Ten

        Evergreen.V15.Card.Jack ->
            Evergreen.V16.Card.Jack

        Evergreen.V15.Card.Queen ->
            Evergreen.V16.Card.Queen

        Evergreen.V15.Card.King ->
            Evergreen.V16.Card.King


migrate_Card_Suit : Evergreen.V15.Card.Suit -> Evergreen.V16.Card.Suit
migrate_Card_Suit old =
    case old of
        Evergreen.V15.Card.Clubs ->
            Evergreen.V16.Card.Clubs

        Evergreen.V15.Card.Diamonds ->
            Evergreen.V16.Card.Diamonds

        Evergreen.V15.Card.Hearts ->
            Evergreen.V16.Card.Hearts

        Evergreen.V15.Card.Spades ->
            Evergreen.V16.Card.Spades


migrate_Types_Counter : Evergreen.V15.Types.Counter -> Evergreen.V16.Types.Counter
migrate_Types_Counter old =
    case old of
        Evergreen.V15.Types.Five ->
            Evergreen.V16.Types.Five

        Evergreen.V15.Types.Four ->
            Evergreen.V16.Types.Four

        Evergreen.V15.Types.Three ->
            Evergreen.V16.Types.Three

        Evergreen.V15.Types.Two ->
            Evergreen.V16.Types.Two

        Evergreen.V15.Types.One ->
            Evergreen.V16.Types.One

        Evergreen.V15.Types.Zero ->
            Evergreen.V16.Types.Zero


migrate_Types_DiscardPile : Evergreen.V15.Types.DiscardPile -> Evergreen.V16.Types.DiscardPile
migrate_Types_DiscardPile old =
    old |> List.map migrate_Card_Card


migrate_Types_FDrawPile : Evergreen.V15.Types.FDrawPile -> Evergreen.V16.Types.FDrawPile
migrate_Types_FDrawPile old =
    old |> List.map migrate_Card_FCard


migrate_Types_FGame : Evergreen.V15.Types.FGame -> Evergreen.V16.Types.FGame
migrate_Types_FGame old =
    case old of
        Evergreen.V15.Types.FWaitingForPlayers p0 ->
            Evergreen.V16.Types.FWaitingForPlayers (p0 |> List.map migrate_Types_FPlayer)

        Evergreen.V15.Types.FGameInProgress p0 p1 p2 p3 p4 p5 ->
            Evergreen.V16.Types.FGameInProgress (p0 |> Maybe.map migrate_Types_TamalouOwner)
                (p1 |> migrate_Types_FTableHand)
                (p2 |> migrate_Types_FDrawPile)
                (p3 |> migrate_Types_DiscardPile)
                (p4 |> List.map migrate_Types_FPlayer)
                (p5 |> migrate_Types_FGameInProgressStatus)

        Evergreen.V15.Types.FGameEnded p0 ->
            Evergreen.V16.Types.FGameEnded p0

        Evergreen.V15.Types.FGameAlreadyStartedWithoutYou ->
            Evergreen.V16.Types.FGameAlreadyStartedWithoutYou


migrate_Types_FGameInProgressStatus : Evergreen.V15.Types.FGameInProgressStatus -> Evergreen.V16.Types.FGameInProgressStatus
migrate_Types_FGameInProgressStatus old =
    case old of
        Evergreen.V15.Types.FStartTimerRunning p0 ->
            Evergreen.V16.Types.FStartTimerRunning (p0 |> migrate_Types_Counter)

        Evergreen.V15.Types.FPlayerToPlay p0 p1 ->
            Evergreen.V16.Types.FPlayerToPlay p0 (p1 |> migrate_Types_FPlayerToPlayStatus)

        Evergreen.V15.Types.FYourTurn p0 ->
            Evergreen.V16.Types.FYourTurn (p0 |> migrate_Types_FPlayerToPlayStatus)

        Evergreen.V15.Types.FEndTimerRunning p0 ->
            Evergreen.V16.Types.FEndTimerRunning (p0 |> migrate_Types_Counter)


migrate_Types_FPlayer : Evergreen.V15.Types.FPlayer -> Evergreen.V16.Types.FPlayer
migrate_Types_FPlayer old =
    { name = old.name
    , tableHand = old.tableHand |> List.map migrate_Card_FCard
    , clientId = old.clientId
    , sessionId = old.sessionId
    }


migrate_Types_FPlayerToPlayStatus : Evergreen.V15.Types.FPlayerToPlayStatus -> Evergreen.V16.Types.FPlayerToPlayStatus
migrate_Types_FPlayerToPlayStatus old =
    case old of
        Evergreen.V15.Types.FWaitingPlayerAction p0 ->
            Evergreen.V16.Types.FWaitingPlayerAction (p0 |> Maybe.map migrate_Card_Power)

        Evergreen.V15.Types.FPlayerHasDraw p0 ->
            Evergreen.V16.Types.FPlayerHasDraw (p0 |> migrate_Card_FCard)

        Evergreen.V15.Types.FPlayerHasDiscard p0 ->
            Evergreen.V16.Types.FPlayerHasDiscard (p0 |> migrate_Card_Power)

        Evergreen.V15.Types.FPlayerLookACard p0 ->
            Evergreen.V16.Types.FPlayerLookACard (p0 |> Maybe.map migrate_Types_Counter)


migrate_Types_FTableHand : Evergreen.V15.Types.FTableHand -> Evergreen.V16.Types.FTableHand
migrate_Types_FTableHand old =
    old |> List.map migrate_Card_FCard


migrate_Types_FrontendMsg : Evergreen.V15.Types.FrontendMsg -> Evergreen.V16.Types.FrontendMsg
migrate_Types_FrontendMsg old =
    case old of
        Evergreen.V15.Types.UrlClicked p0 ->
            Evergreen.V16.Types.UrlClicked p0

        Evergreen.V15.Types.UrlChanged p0 ->
            Evergreen.V16.Types.UrlChanged p0

        Evergreen.V15.Types.NoOpFrontendMsg ->
            Evergreen.V16.Types.NoOpFrontendMsg

        Evergreen.V15.Types.DrawCardFromDeckFrontend ->
            Evergreen.V16.Types.DrawCardFromDeckFrontend

        Evergreen.V15.Types.TamalouFrontend ->
            Evergreen.V16.Types.TamalouFrontend

        Evergreen.V15.Types.DiscardCardFrontend ->
            Evergreen.V16.Types.DiscardCardFrontend

        Evergreen.V15.Types.DrawFromDiscardPileFrontend ->
            Evergreen.V16.Types.DrawFromDiscardPileFrontend

        Evergreen.V15.Types.PowerIsUsedFrontend ->
            Evergreen.V16.Types.PowerIsUsedFrontend

        Evergreen.V15.Types.PowerPassFrontend ->
            Evergreen.V16.Types.PowerPassFrontend

        Evergreen.V15.Types.ReplaceCardInFrontend p0 ->
            Evergreen.V16.Types.ReplaceCardInFrontend p0

        Evergreen.V15.Types.DoubleCardFrontend p0 ->
            Evergreen.V16.Types.DoubleCardFrontend p0

        Evergreen.V15.Types.LookAtCardFrontend p0 ->
            Evergreen.V16.Types.LookAtCardFrontend p0

        Evergreen.V15.Types.GotWindowSize p0 ->
            Evergreen.V16.Types.GotWindowSize { width = 0, height = 0 }


migrate_Types_TamalouOwner : Evergreen.V15.Types.TamalouOwner -> Evergreen.V16.Types.TamalouOwner
migrate_Types_TamalouOwner old =
    { sessionId = old.sessionId
    , tableHand = old.tableHand |> List.map migrate_Card_Card
    }
